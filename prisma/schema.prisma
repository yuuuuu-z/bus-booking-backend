generator client {
  provider = "prisma-client-js"
  output   = "../generated/prisma"
}

datasource db {
  provider = "postgresql"
  // url      = env("DATABASE_URL")
}
model User {
  id        Int      @id @default(autoincrement())
  name      String
  email     String   @unique
 password  String?  // Optional for Google OAuth users
  googleId  String?  @unique  // Store Google's user ID
  avatar    String?
  provider  String   @default("local") // "local" or "google"
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

 otp         String?
  otpExpires  DateTime?
  isVerified  Boolean  @default(false)

  bookings  Booking[]

  @@map("users")
}


  model Province {
    id    Int    @id @default(autoincrement())
    name  String @unique
    image String

    fromBookings Booking[] @relation("FromProvinceBooking")
    toBookings   Booking[] @relation("ToProvinceBooking")

    @@map("province")
  }
model Booking {
  id Int @id @default(autoincrement())

  userId Int

  fromProvinceId Int
  toProvinceId   Int

  travelDate DateTime

  timeLabel String
  startTime String
  endTime   String

  tickets Int

   pricePerTicket Float
  totalPrice Float

  status String @default("PENDING")

  paymentRef String? // Stores MD5
  bakongHash String? // Stores Bakong Transaction Hash (on success)
  
  // Optional: tracking more info from Bakong data
  currency   String?
  amount     Float?
  paidAt     DateTime?

  createdAt DateTime @default(now())

  user User @relation(fields: [userId], references: [id])

  fromProvince Province @relation("FromProvinceBooking", fields: [fromProvinceId], references: [id])
  toProvince   Province @relation("ToProvinceBooking", fields: [toProvinceId], references: [id])

  @@map("booking")
}

